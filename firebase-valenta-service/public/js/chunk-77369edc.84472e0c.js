(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-77369edc"],{"91be":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-container",{attrs:{id:"users",fluid:"",tag:"section"}},[a("base-material-card",{staticClass:"px-5 py-3",style:"lg"===e.breakpointName?"margin-top: 90px":"margin-top: 20px",attrs:{icon:"mdi-clipboard-text",title:"Danh sách thành viên"}},[a("v-card-text",{class:"lg"!==e.breakpointName?"px-0":""},[a("div",{class:"xs"===e.breakpointName?"mb-3":"d-flex mb-3"},["xs"===e.breakpointName?a("div",{staticClass:"mr-auto pt-2 mb-3"},[e._v(" Tổng số: "),a("span",{staticStyle:{"font-weight":"bold",color:"green"}},[e._v(e._s(e.totalItem))]),e._v(" thành viên ")]):a("span",{staticClass:"mr-auto pt-2"},[e._v(" Tổng số: "),a("span",{staticStyle:{"font-weight":"bold",color:"green"}},[e._v(e._s(e.totalItem))]),e._v(" thành viên ")]),a("v-btn",{staticClass:"mx-0",attrs:{color:"success"},on:{click:function(t){return t.stopPropagation(),e.addMember("add")}}},[a("v-icon",{attrs:{left:"",size:"22"}},[e._v(" mdi-plus ")]),e._v(" Thêm thành viên ")],1)],1),a("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.items,page:e.page,"items-per-page":e.itemsPerPage,"hide-default-footer":"","no-data-text":"Không có thành viên nào",loading:e.loadingData,"loading-text":"Đang tải... "},on:{"update:page":function(t){e.page=t},"page-count":function(t){e.pageCount=t}},scopedSlots:e._u([{key:"item.index",fn:function(t){t.item;var n=t.index;return[a("span",[e._v(e._s(n+1))])]}},{key:"item.role",fn:function(t){var n=t.item;return[n.hasOwnProperty("role")&&"Admin"===n.role?a("span",{staticStyle:{color:"red"}},[e._v("Quản trị")]):a("span",{staticStyle:{color:"blue"}},[e._v("Thành viên")])]}},{key:"item.action",fn:function(t){var n=t.item;return[a("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var o=t.on,i=t.attrs;return[a("v-btn",e._g(e._b({attrs:{color:"blue",text:"",icon:""},on:{click:function(t){return e.addMember("update",n)}}},"v-btn",i,!1),o),[a("v-icon",{attrs:{size:"22"}},[e._v("mdi-pencil")])],1)]}}],null,!0)},[a("span",[e._v("Cập nhật thông tin")])])]}}])}),a("div",{staticClass:"text-center mt-4"},[a("v-pagination",{attrs:{length:e.pageCount},model:{value:e.page,callback:function(t){e.page=t},expression:"page"}})],1)],1)],1),a("v-dialog",{attrs:{"max-width":"600"},model:{value:e.dialogAddMember,callback:function(t){e.dialogAddMember=t},expression:"dialogAddMember"}},[a("v-card",[a("v-toolbar",{attrs:{dark:"",color:"primary"}},["add"===e.typeAction?a("v-toolbar-title",[e._v("Thêm thành viên hệ thống")]):a("v-toolbar-title",[e._v("Cập nhật thông tin")]),a("v-spacer"),a("v-toolbar-items",[a("v-btn",{attrs:{icon:"",dark:""},on:{click:function(t){e.dialogAddMember=!1}}},[a("v-icon",[e._v("mdi-close")])],1)],1)],1),a("v-card-text",{staticClass:"mt-5"},[a("v-form",{ref:"formAddMember",attrs:{"lazy-validation":""},model:{value:e.validFormAdd,callback:function(t){e.validFormAdd=t},expression:"validFormAdd"}},["add"===e.typeAction?a("v-text-field",{attrs:{rules:e.accountRules,counter:75,required:"",outlined:"",label:"Tên đăng nhập","prepend-inner-icon":"mdi-account-check-outline",dense:"",clearable:""},model:{value:e.account,callback:function(t){e.account=t},expression:"account"}}):e._e(),"add"===e.typeAction?a("v-text-field",{attrs:{rules:e.passwordRules,required:"",outlined:"",label:"Mật khẩu đăng nhập","prepend-inner-icon":"mdi-lock-check-outline",dense:"",clearable:""},model:{value:e.passWord,callback:function(t){e.passWord=t},expression:"passWord"}}):e._e(),a("v-text-field",{attrs:{rules:e.nameRules,required:"",outlined:"",counter:100,label:"Tên thành viên","prepend-inner-icon":"mdi-card-account-details-outline",dense:"",clearable:""},model:{value:e.userName,callback:function(t){e.userName=t},expression:"userName"}}),a("v-text-field",{attrs:{rules:e.telNoRules,required:"",outlined:"",label:"Số điện thoại","prepend-inner-icon":"mdi-phone-in-talk-outline",dense:"",clearable:""},model:{value:e.telNo,callback:function(t){e.telNo=t},expression:"telNo"}}),a("v-text-field",{attrs:{rules:e.addressRules,counter:200,outlined:"",label:"Địa chỉ","prepend-inner-icon":"mdi-map-marker",dense:"",clearable:""},model:{value:e.address,callback:function(t){e.address=t},expression:"address"}})],1)],1),a("v-card-actions",{staticClass:"justify-end"},[a("v-btn",{staticClass:"white--text mr-2",attrs:{color:"red",loading:e.loading,disabled:e.loading},on:{click:e.cancelAddMember}},[a("v-icon",{attrs:{left:""}},[e._v(" mdi-close ")]),e._v(" Thoát ")],1),a("v-btn",{staticClass:"mr-2",attrs:{color:"primary",loading:e.loading,disabled:e.loading},on:{click:e.submitAddMember}},[a("v-icon",{attrs:{left:""}},[e._v(" mdi-content-save ")]),"add"===e.typeAction?a("span",[e._v("Thêm mới")]):a("span",[e._v("Cập nhật")])],1)],1)],1)],1)],1)],1)},o=[],i=(a("159b"),a("498a"),{name:"Users",data:function(){return{loading:!1,loadingData:!1,dialogAddMember:!1,totalItem:0,page:1,pageCount:0,itemsPerPage:5,typeAction:"",userUpdate:"",items:[],validFormAdd:!0,userName:"",nameRules:[function(e){return!!e||"Tên thành viên là bắt buộc"},function(e){return e&&e.length<=100||"Tên không quá 100 ký tự"}],account:"",accountRules:[function(e){return!!e||"Tên đăng nhập là bắt buộc"},function(e){return/^[a-zA-Z0-9]+$/.test(e)||"Tên đăng nhập gồm chữ hoặc số"},function(e){return e&&e.length<=75||"Tên đăng nhập không quá 75 ký tự"}],passWord:"",passwordRules:[function(e){return!!e||"Mật khẩu đăng nhập là bắt buộc"},function(e){return e&&e.length>=6&&e.length<=20||"Mật khẩu ít nhất 6 ký tự"}],telNo:"",telNoRules:[function(e){return!!e||"Số điện thoại là bắt buộc"},function(e){return/^0([1-9]{1}\d{8})$/.test(e)||"Số điện thoại gồm 10 chữ số"}],address:"",addressRules:[function(e){return e&&e.length<=200||"Địa chỉ không quá 200 ký tự"}],headers:[{sortable:!1,text:"STT",align:"center",value:"index"},{sortable:!1,text:"Tên",align:"center",value:"userName"},{sortable:!1,text:"Tên đăng nhập",value:"account"},{sortable:!1,text:"Số điện thoại",align:"center",value:"telNo"},{sortable:!1,text:"Địa chỉ",align:"center",value:"address"},{sortable:!1,text:"Loại tài khoản",align:"center",value:"role"},{sortable:!1,text:"Thao tác",align:"center",value:"action"}]}},created:function(){var e=this;e.getMembers()},methods:{getMembers:function(){var e=this;e.loadingData=!0,db.collection("users").get().then((function(t){e.loadingData=!1;var a=[];t.size?(t.docs.forEach((function(e){a.push(e.data())})),e.items=a,console.log("memberList",e.items),e.totalItem=t.size,e.pageCount=Math.ceil(t.size/e.itemsPerPage)):e.items=[]})).catch((function(){e.loadingData=!1}))},addMember:function(e,t){var a=this;a.typeAction=e,a.userUpdate=t,a.dialogAddMember=!0,"add"===e?setTimeout((function(){a.account="",a.passWord="",a.userName="",a.telNo="",a.address="",a.$refs.formAddMember.resetValidation()}),200):setTimeout((function(){a.account=t.account,a.userName=t.userName,a.telNo=t.telNo,a.address=t.address,a.$refs.formAddMember.resetValidation()}),200)},updateStatusUser:function(e,t){var a=this;a.userUpdate=t},deleteUser:function(e){},submitAddMember:function(){var e=this;if(e.$refs.formAddMember.validate())if("add"===e.typeAction){var t={account:String(e.account).trim()+"@gmail.com",passWord:String(e.passWord).trim(),userName:String(e.userName).trim(),telNo:String(e.telNo).trim(),address:String(e.address).trim()};e.loading=!0;var a=firebase.auth().currentUser,n=a["uid"],o=db.collection("users").doc(n),i=a["email"],r="";o.get().then((function(e){e.exists&&(r=window.atob(e.data()["pid"]))})).catch((function(e){})),firebase.auth().createUserWithEmailAndPassword(t.account,t.passWord).then((function(a){e.loading=!1,e.$store.commit("SHOW_SNACKBAR",{show:!0,text:"Thêm thành viên thành công",color:"success"}),e.dialogAddMember=!1,firebase.auth().signInWithEmailAndPassword(i,r).then((function(){var n=a.user;db.collection("users").doc(n.uid).set({account:String(e.account).trim(),userName:t.userName,telNo:t.telNo,address:t.address,role:"Member",status:"",uid:n.uid}).then((function(){e.getMembers()})).catch((function(e){}))}))})).catch((function(t){e.loading=!1;var a=t.code,n=t.message,o="";o="auth/email-already-in-use"==a?"Tên đăng nhập đã được sử dụng. Vui lòng sử dụng tên đăng nhập khác.":"auth/weak-password"==a?"Mật khẩu quá yếu":"auth/invalid-email"==a?"Tên đăng nhập không hợp lệ":n,e.$store.commit("SHOW_SNACKBAR",{show:!0,text:o,color:"error"})}))}else e.loading=!0,db.collection("users").doc(e.userUpdate["uid"]).update({userName:e.userName,telNo:e.telNo,address:e.address}).then((function(){e.loading=!1,e.$store.commit("SHOW_SNACKBAR",{show:!0,text:"Cập nhật thành công",color:"success"}),e.dialogAddMember=!1,e.getMembers()})).catch((function(){e.$store.commit("SHOW_SNACKBAR",{show:!0,text:"Cập nhật thất bại",color:"error"})}))},cancelAddMember:function(){var e=this;e.dialogAddMember=!1}}}),r=i,s=(a("97b9"),a("2877")),l=a("6544"),c=a.n(l),d=a("8336"),u=a("b0af"),m=a("99d9"),h=a("a523"),p=a("8fea"),g=a("169a"),b=a("4bd4"),v=a("132d"),f=a("891e"),x=a("2fa4"),k=a("8654"),A=a("71d9"),N=a("2a7f"),_=a("3a2f"),T=Object(s["a"])(r,n,o,!1,null,"085ec11e",null);t["default"]=T.exports;c()(T,{VBtn:d["a"],VCard:u["a"],VCardActions:m["a"],VCardText:m["b"],VContainer:h["a"],VDataTable:p["a"],VDialog:g["a"],VForm:b["a"],VIcon:v["a"],VPagination:f["a"],VSpacer:x["a"],VTextField:k["a"],VToolbar:A["a"],VToolbarItems:N["a"],VToolbarTitle:N["b"],VTooltip:_["a"]})},"97b9":function(e,t,a){"use strict";a("a079")},a079:function(e,t,a){}}]);
//# sourceMappingURL=chunk-77369edc.84472e0c.js.map