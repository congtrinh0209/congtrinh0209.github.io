(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-542a635c"],{b204:function(e,t,n){},c3b1:function(e,t,n){"use strict";n("b204")},da94:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-container",{attrs:{id:"users",fluid:"",tag:"section"}},[n("base-material-card",{staticClass:"px-5 py-3",style:"lg"===e.breakpointName?"margin-top: 90px":"margin-top: 20px",attrs:{icon:"mdi-clipboard-text",title:"Danh sách nhân viên, đại lý bán hàng"}},[n("v-card-text",{class:"lg"!==e.breakpointName?"px-0":""},[n("div",{class:"xs"===e.breakpointName?"mb-3":"d-flex mb-3"},["xs"===e.breakpointName?n("div",{staticClass:"mr-auto pt-2 mb-3"},[e._v(" Tổng số: "),n("span",{staticStyle:{"font-weight":"bold",color:"green"}},[e._v(e._s(e.totalItem))]),e._v(" nhân viên, đại lý bán hàng ")]):n("span",{staticClass:"mr-auto pt-2"},[e._v(" Tổng số: "),n("span",{staticStyle:{"font-weight":"bold",color:"green"}},[e._v(e._s(e.totalItem))]),e._v(" nhân viên, đại lý bán hàng ")]),n("v-btn",{staticClass:"mx-0",attrs:{color:"success"},on:{click:function(t){return t.stopPropagation(),e.addMember("add")}}},[n("v-icon",{attrs:{left:"",size:"22"}},[e._v(" mdi-plus ")]),e._v(" Thêm nhân viên, đại lý ")],1)],1),n("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.items,page:e.page,"items-per-page":e.itemsPerPage,"hide-default-footer":"","no-data-text":"Không có nhân viên, đại lý bán hàng nào",loading:e.loadingData,"loading-text":"Đang tải... "},on:{"update:page":function(t){e.page=t},"page-count":function(t){e.pageCount=t}},scopedSlots:e._u([{key:"item.index",fn:function(t){t.item;var a=t.index;return[n("span",[e._v(e._s(a+1))])]}},{key:"item.role",fn:function(t){var a=t.item;return[a.hasOwnProperty("role")&&"Admin"===a.role?n("span",{staticStyle:{color:"red"}},[e._v("Quản trị")]):n("span",{staticStyle:{color:"blue"}},[e._v("nhân viên, đại lý bán hàng")])]}},{key:"item.action",fn:function(t){var a=t.item;return[n("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var o=t.on,i=t.attrs;return[n("v-btn",e._g(e._b({attrs:{color:"blue",text:"",icon:""},on:{click:function(t){return e.addMember("update",a)}}},"v-btn",i,!1),o),[n("v-icon",{attrs:{size:"22"}},[e._v("mdi-pencil")])],1)]}}],null,!0)},[n("span",[e._v("Cập nhật thông tin")])])]}}])}),n("div",{staticClass:"text-center mt-4"},[n("v-pagination",{attrs:{length:e.pageCount},model:{value:e.page,callback:function(t){e.page=t},expression:"page"}})],1)],1)],1),n("v-dialog",{attrs:{"max-width":"600"},model:{value:e.dialogAddMember,callback:function(t){e.dialogAddMember=t},expression:"dialogAddMember"}},[n("v-card",[n("v-toolbar",{attrs:{dark:"",color:"primary"}},["add"===e.typeAction?n("v-toolbar-title",[e._v("Thêm nhân viên, đại lý bán hàng")]):n("v-toolbar-title",[e._v("Cập nhật thông tin")]),n("v-spacer"),n("v-toolbar-items",[n("v-btn",{attrs:{icon:"",dark:""},on:{click:function(t){e.dialogAddMember=!1}}},[n("v-icon",[e._v("mdi-close")])],1)],1)],1),n("v-card-text",{staticClass:"mt-5"},[n("v-form",{ref:"formAddMember",attrs:{"lazy-validation":""},model:{value:e.validFormAdd,callback:function(t){e.validFormAdd=t},expression:"validFormAdd"}},["add"===e.typeAction?n("v-text-field",{attrs:{rules:e.accountRules,counter:75,required:"",outlined:"",label:"Tên đăng nhập","prepend-inner-icon":"mdi-account-check-outline",dense:"",clearable:""},model:{value:e.account,callback:function(t){e.account=t},expression:"account"}}):e._e(),"add"===e.typeAction?n("v-text-field",{attrs:{rules:e.passwordRules,required:"",outlined:"",label:"Mật khẩu đăng nhập","prepend-inner-icon":"mdi-lock-check-outline",dense:"",clearable:""},model:{value:e.passWord,callback:function(t){e.passWord=t},expression:"passWord"}}):e._e(),n("v-text-field",{attrs:{rules:e.nameRules,required:"",outlined:"",counter:100,label:"Tên nhân viên, đại lý bán hàng","prepend-inner-icon":"mdi-card-account-details-outline",dense:"",clearable:""},model:{value:e.userName,callback:function(t){e.userName=t},expression:"userName"}}),n("v-text-field",{attrs:{rules:e.telNoRules,required:"",outlined:"",label:"Số điện thoại","prepend-inner-icon":"mdi-phone-in-talk-outline",dense:"",clearable:""},model:{value:e.telNo,callback:function(t){e.telNo=t},expression:"telNo"}}),n("v-text-field",{attrs:{rules:e.addressRules,counter:200,outlined:"",label:"Địa chỉ","prepend-inner-icon":"mdi-map-marker",dense:"",clearable:""},model:{value:e.address,callback:function(t){e.address=t},expression:"address"}})],1)],1),n("v-card-actions",{staticClass:"justify-end"},[n("v-btn",{staticClass:"white--text mr-2",attrs:{color:"red",loading:e.loading,disabled:e.loading},on:{click:e.cancelAddMember}},[n("v-icon",{attrs:{left:""}},[e._v(" mdi-close ")]),e._v(" Thoát ")],1),n("v-btn",{staticClass:"mr-2",attrs:{color:"primary",loading:e.loading,disabled:e.loading},on:{click:e.submitAddMember}},[n("v-icon",{attrs:{left:""}},[e._v(" mdi-content-save ")]),"add"===e.typeAction?n("span",[e._v("Thêm mới")]):n("span",[e._v("Cập nhật")])],1)],1)],1)],1)],1)],1)},o=[],i=(n("159b"),n("498a"),{name:"Users",data:function(){return{loading:!1,loadingData:!1,dialogAddMember:!1,totalItem:0,page:1,pageCount:0,itemsPerPage:5,typeAction:"",userUpdate:"",items:[],validFormAdd:!0,userName:"",nameRules:[function(e){return!!e||"Tên nhân viên, đại lý bán hàng là bắt buộc"},function(e){return e&&e.length<=100||"Tên không quá 100 ký tự"}],account:"",accountRules:[function(e){return!!e||"Tên đăng nhập là bắt buộc"},function(e){return/^[a-zA-Z0-9]+$/.test(e)||"Tên đăng nhập gồm chữ hoặc số"},function(e){return e&&e.length<=75||"Tên đăng nhập không quá 75 ký tự"}],passWord:"",passwordRules:[function(e){return!!e||"Mật khẩu đăng nhập là bắt buộc"},function(e){return e&&e.length>=6&&e.length<=20||"Mật khẩu ít nhất 6 ký tự"}],telNo:"",telNoRules:[function(e){return!!e||"Số điện thoại là bắt buộc"},function(e){return/^0([1-9]{1}\d{8})$/.test(e)||"Số điện thoại gồm 10 chữ số"}],address:"",addressRules:[function(e){return e&&e.length<=200||"Địa chỉ không quá 200 ký tự"}],headers:[{sortable:!1,text:"STT",align:"center",value:"index"},{sortable:!1,text:"Tên",align:"center",value:"userName"},{sortable:!1,text:"Tên đăng nhập",value:"account"},{sortable:!1,text:"Số điện thoại",align:"center",value:"telNo"},{sortable:!1,text:"Địa chỉ",align:"center",value:"address"},{sortable:!1,text:"Loại tài khoản",align:"center",value:"role"},{sortable:!1,text:"Thao tác",align:"center",value:"action"}]}},created:function(){var e=this;e.getMembers()},methods:{getMembers:function(){var e=this;e.loadingData=!0,db.collection("users").get().then((function(t){e.loadingData=!1;var n=[];t.size?(t.docs.forEach((function(e){n.push(e.data())})),e.items=n,console.log("memberList",e.items),e.totalItem=t.size,e.pageCount=Math.ceil(t.size/e.itemsPerPage)):e.items=[]})).catch((function(){e.loadingData=!1}))},addMember:function(e,t){var n=this;n.typeAction=e,n.userUpdate=t,n.dialogAddMember=!0,"add"===e?setTimeout((function(){n.account="",n.passWord="",n.userName="",n.telNo="",n.address="",n.$refs.formAddMember.resetValidation()}),200):setTimeout((function(){n.account=t.account,n.userName=t.userName,n.telNo=t.telNo,n.address=t.address,n.$refs.formAddMember.resetValidation()}),200)},updateStatusUser:function(e,t){var n=this;n.userUpdate=t},deleteUser:function(e){},submitAddMember:function(){var e=this;if(e.$refs.formAddMember.validate())if("add"===e.typeAction){var t={account:String(e.account).trim()+"@gmail.com",passWord:String(e.passWord).trim(),userName:String(e.userName).trim(),telNo:String(e.telNo).trim(),address:String(e.address).trim()};e.loading=!0;var n=firebase.auth().currentUser,a=n["uid"],o=db.collection("users").doc(a),i=n["email"],r="";o.get().then((function(e){e.exists&&(r=window.atob(e.data()["pid"]))})).catch((function(e){})),firebase.auth().createUserWithEmailAndPassword(t.account,t.passWord).then((function(n){e.loading=!1,e.$store.commit("SHOW_SNACKBAR",{show:!0,text:"Thêm nhân viên, đại lý bán hàng thành công",color:"success"}),e.dialogAddMember=!1,firebase.auth().signInWithEmailAndPassword(i,r).then((function(){var a=n.user;db.collection("users").doc(a.uid).set({account:String(e.account).trim(),userName:t.userName,telNo:t.telNo,address:t.address,role:"Member",status:"",uid:a.uid}).then((function(){e.getMembers()})).catch((function(e){}))}))})).catch((function(t){e.loading=!1;var n=t.code,a=t.message,o="";o="auth/email-already-in-use"==n?"Tên đăng nhập đã được sử dụng. Vui lòng sử dụng tên đăng nhập khác.":"auth/weak-password"==n?"Mật khẩu quá yếu":"auth/invalid-email"==n?"Tên đăng nhập không hợp lệ":a,e.$store.commit("SHOW_SNACKBAR",{show:!0,text:o,color:"error"})}))}else e.loading=!0,db.collection("users").doc(e.userUpdate["uid"]).update({userName:e.userName,telNo:e.telNo,address:e.address}).then((function(){e.loading=!1,e.$store.commit("SHOW_SNACKBAR",{show:!0,text:"Cập nhật thành công",color:"success"}),e.dialogAddMember=!1,e.getMembers()})).catch((function(){e.$store.commit("SHOW_SNACKBAR",{show:!0,text:"Cập nhật thất bại",color:"error"})}))},cancelAddMember:function(){var e=this;e.dialogAddMember=!1}}}),r=i,s=(n("c3b1"),n("2877")),l=n("6544"),c=n.n(l),d=n("8336"),u=n("b0af"),m=n("99d9"),h=n("a523"),g=n("8fea"),b=n("169a"),p=n("4bd4"),v=n("132d"),f=n("891e"),x=n("2fa4"),k=n("8654"),A=n("71d9"),N=n("2a7f"),_=n("3a2f"),T=Object(s["a"])(r,a,o,!1,null,"22494bde",null);t["default"]=T.exports;c()(T,{VBtn:d["a"],VCard:u["a"],VCardActions:m["a"],VCardText:m["b"],VContainer:h["a"],VDataTable:g["a"],VDialog:b["a"],VForm:p["a"],VIcon:v["a"],VPagination:f["a"],VSpacer:x["a"],VTextField:k["a"],VToolbar:A["a"],VToolbarItems:N["a"],VToolbarTitle:N["b"],VTooltip:_["a"]})}}]);
//# sourceMappingURL=chunk-542a635c.77484063.js.map