<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <link rel="icon" href="/images/favicon.ico">
    <title>Hanoi Paint - Bảo hành</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@mdi/font@latest/css/materialdesignicons.min.css">
  </head>
  <body>
    <noscript>
      <strong>We're sorry but material doesn't work properly without JavaScript enabled. Please enable it to continue.</strong>
    </noscript>
    <div id="app"></div>
    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/8.6.2/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.2/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.2/firebase-firestore.js"></script>
    <!-- TODO: Add SDKs for Firebase products that you want to use
        https://firebase.google.com/docs/web/setup#available-libraries -->
    <script src="https://www.gstatic.com/firebasejs/8.6.2/firebase-analytics.js"></script>

    <script>
      // Your web app's Firebase configuration
      // For Firebase JS SDK v7.20.0 and later, measurementId is optional
      var firebaseConfig = {
          apiKey: "AIzaSyDsNErw1yZVP1b-3IQgeWPFb9J_77yKDjs",
          authDomain: "valenta-service.firebaseapp.com",
          projectId: "valenta-service",
          storageBucket: "valenta-service.appspot.com",
          messagingSenderId: "721439275923",
          appId: "1:721439275923:web:2f471e8c214d4822630666",
          measurementId: "G-5W3J1EFEXS"
      };
      // Initialize Firebase
      firebase.initializeApp(firebaseConfig);
      firebase.analytics();
      const db = firebase.firestore();
      // [START create_counter]
      function createCounter(ref, num_shards) {
          var batch = db.batch();

          // Initialize the counter document
          batch.set(ref, { num_shards: num_shards });

          // Initialize each shard with count=0
          for (let i = 0; i < num_shards; i++) {
              const shardRef = ref.collection('shards').doc(i.toString());
              batch.set(shardRef, { count: 0 });
          }

          // Commit the write batch
          return batch.commit();
      }
      // [END create_counter]

      // [START increment_counter]
      function incrementCounter(db, ref, num_shards) {
          // Select a shard of the counter at random
          const shard_id = Math.floor(Math.random() * num_shards).toString();
          const shard_ref = ref.collection('shards').doc(shard_id);

          // Update count
          return shard_ref.update("count", firebase.firestore.FieldValue.increment(1));
      }
      function decrementCounter(db, ref, num_shards) {
          // Select a shard of the counter at random
          const shard_id = Math.floor(Math.random() * num_shards).toString();
          const shard_ref = ref.collection('shards').doc(shard_id);

          // Update count
          return shard_ref.update("count", firebase.firestore.FieldValue.increment(-1));
      }
      // [END increment_counter]

      // [START get_count]
      function getCount(ref, pagesize) {
          // Sum the count of each shard in the subcollection
          return ref.collection('shards').get().then((snapshot) => {
            let total = 0
            let pagination = {
              total_count: 0,
              pageCount: 0
            }
            
            snapshot.forEach((doc) => {
              total += doc.data().count
            })
            pagination.total_count = total
            if (total && pagesize) {
              pagination.pageCount = Math.ceil(total / pagesize)
            }
            console.log('pagination', pagination)
            return pagination
          });
      }
      // [END get_count]
    </script>
    <!-- built files will be auto injected -->
  </body>
</html>
